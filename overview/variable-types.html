
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', 'G-F9LD9HL8LW', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Variable Types for Tensors and Constants &#8212; Kompute Documentation (Python &amp; C++)</title>
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/assets/custom.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Asynchronous and Parallel Operations" href="async-parallel.html" />
    <link rel="prev" title="CI, Docker Images, Docs &amp; Tests" href="ci-tests.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=red data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#overview/variable-types" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Kompute Documentation (Python &amp; C++)"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Kompute Documentation (Python & C++)</span>
          <span class="md-header-nav__topic"> Variable Types for Tensors and Constants </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/KomputeProject/kompute/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Kompute
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Kompute Documentation (Python & C++)</a></li>
            
            <li class="md-tabs__item"><a href="https://github.com/KomputeProject/kompute/" class="md-tabs__link">Kompute Repo</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Kompute Documentation (Python &amp; C++)" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Kompute Documentation (Python &amp; C++)">Kompute Documentation (Python & C++)</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/KomputeProject/kompute/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Kompute
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="https://kompute.cc/" class="md-nav__link">Documentation Home</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">C++ Documentation:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="advanced-examples.html" class="md-nav__link">C++ Examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="memory-management.html" class="md-nav__link">Memory Management Principles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="build-system.html" class="md-nav__link">Build System Deep Dive</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="shaders-to-headers.html" class="md-nav__link">Processing Shaders (Online & Offline)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="custom-operations.html" class="md-nav__link">Extending Kompute with Custom Operations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="reference.html" class="md-nav__link">C++ Class Documentation & Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://kompute.cc/codecov/" class="md-nav__link">Test Code Coverage</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Python Documentation:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="python-package.html" class="md-nav__link">Python Package Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="python-reference.html" class="md-nav__link">Python Class Documentation & Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Examples:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="python-examples.html" class="md-nav__link">Python Examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="advanced-examples.html" class="md-nav__link">C++ Examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mobile-android.html" class="md-nav__link">Android Mobile App Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="raspberry-pi.html" class="md-nav__link">Edge Device Raspberry Pi Mesa Drivers</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="game-engine-godot.html" class="md-nav__link">Game Engine Godot Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="matmul-benchmark.html" class="md-nav__link">Example Benchmark with Matrix Multiplication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="convolutional-net.html" class="md-nav__link">Convolutional Neural Network (CNN) Simple Upscale</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Advanced Concepts &amp; Deep Dives:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ci-tests.html" class="md-nav__link">CI, Docker Images Docs & Tests</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Variable Types for Tensors, and Push/Spec Constants </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Variable Types for Tensors, and Push/Spec Constants</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#overview-variable-types--page-root" class="md-nav__link">Variable Types for Tensors and Constants</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#variable-tensor-types" class="md-nav__link">Variable Tensor Types</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#c-tensor-types-usage" class="md-nav__link">C++ Tensor Types Usage</a>
        </li>
        <li class="md-nav__item"><a href="#python-tensor-types-usage" class="md-nav__link">Python Tensor Types Usage</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#variable-push-constants" class="md-nav__link">Variable Push Constants</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#c-push-consts-types-usage" class="md-nav__link">C++ Push Consts Types Usage</a>
        </li>
        <li class="md-nav__item"><a href="#python-push-consts-types-usage" class="md-nav__link">Python Push Consts Types Usage</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#variable-specialization-constants" class="md-nav__link">Variable Specialization Constants</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">C++ Push Consts Types Usage</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/overview/variable-types.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="async-parallel.html" class="md-nav__link">Asynchronous & Parallel Operations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../genindex.html" class="md-nav__link">Code Index</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#overview-variable-types--page-root" class="md-nav__link">Variable Types for Tensors and Constants</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#variable-tensor-types" class="md-nav__link">Variable Tensor Types</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#c-tensor-types-usage" class="md-nav__link">C++ Tensor Types Usage</a>
        </li>
        <li class="md-nav__item"><a href="#python-tensor-types-usage" class="md-nav__link">Python Tensor Types Usage</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#variable-push-constants" class="md-nav__link">Variable Push Constants</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#c-push-consts-types-usage" class="md-nav__link">C++ Push Consts Types Usage</a>
        </li>
        <li class="md-nav__item"><a href="#python-push-consts-types-usage" class="md-nav__link">Python Push Consts Types Usage</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#variable-specialization-constants" class="md-nav__link">Variable Specialization Constants</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">C++ Push Consts Types Usage</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/overview/variable-types.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="overview-variable-types--page-root">Variable Types for Tensors and Constants<a class="headerlink" href="#overview-variable-types--page-root" title="Permalink to this headline">¶</a></h1>
<p>By default the initial interfaces you may interact with, will be primarily using float values by default, which is enough to get through the basic conceptual examples. However as real world applications are being developed, more specialized types may be required for kp::Tensor, as well as for SpecializationConstants and PushConstants.</p>
<p>Before diving into the practical classes and interfaces that can be used to take advantage of the variable type support of Kompute, we want to provide some high level intution on what each of these components are.</p>

<h2 id="variable-tensor-types">Variable Tensor Types<a class="headerlink" href="#variable-tensor-types" title="Permalink to this headline">¶</a></h2>
<p>For the kp::Tensor class, Kompute provides under the hood an interface to have more seamless interaction with multiple different underlying data types. This is done through the introduction of the class kp::TensorT&lt;type&gt; and parent class kp::Tensor, however you as a developer you will be primarily interacting with the top level kp::Tensor class, as this is what is provided through the high level kp::Manager class.</p>
<p>The kp::Tensor class does provide an “integrated” experience, which allows users to “seamlessly” retrieve the underlying data through the <cite>data()</cite> and <cite>vector()</cite> functions. This is done by leveraging C++ templates, as well as limiting the types that can be used, which are namely:</p>
<ul class="simple">
<li><p>float</p></li>
<li><p>uint32</p></li>
<li><p>int32</p></li>
<li><p>double</p></li>
<li><p>bool</p></li>
</ul>
<p>Any other data type provided would result in an error, and for the time being Kompute will focus on primarily provide support for these classes.</p>
<p>The tests under <cite>TestTensor.cpp</cite> and <cite>test_tensor_types.py</cite> provide an overview of how users can take advantage of these features using std::vector for C++ and numpy array for Python.</p>

<h3 id="c-tensor-types-usage">C++ Tensor Types Usage<a class="headerlink" href="#c-tensor-types-usage" title="Permalink to this headline">¶</a></h3>
<p>Below you can see how it is possible to define different types in C++.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>    <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">};</span>
        <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">TensorT</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;&gt;</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">mgr</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">vec</span><span class="p">);</span>
        <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">dataType</span><span class="p">(),</span> <span class="n">kp</span><span class="o">::</span><span class="n">Tensor</span><span class="o">::</span><span class="n">TensorDataTypes</span><span class="o">::</span><span class="n">eFloat</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">};</span>
        <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">TensorT</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;&gt;</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">mgr</span><span class="p">.</span><span class="n">tensorT</span><span class="p">(</span><span class="n">vec</span><span class="p">);</span>
        <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">dataType</span><span class="p">(),</span> <span class="n">kp</span><span class="o">::</span><span class="n">Tensor</span><span class="o">::</span><span class="n">TensorDataTypes</span><span class="o">::</span><span class="n">eInt</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">};</span>
        <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">TensorT</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;&gt;</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">mgr</span><span class="p">.</span><span class="n">tensorT</span><span class="p">(</span><span class="n">vec</span><span class="p">);</span>
        <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">dataType</span><span class="p">(),</span> <span class="n">kp</span><span class="o">::</span><span class="n">Tensor</span><span class="o">::</span><span class="n">TensorDataTypes</span><span class="o">::</span><span class="n">eUnsignedInt</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">vec</span><span class="p">{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">};</span>
        <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">TensorT</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">mgr</span><span class="p">.</span><span class="n">tensorT</span><span class="p">(</span><span class="n">vec</span><span class="p">);</span>
        <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">dataType</span><span class="p">(),</span> <span class="n">kp</span><span class="o">::</span><span class="n">Tensor</span><span class="o">::</span><span class="n">TensorDataTypes</span><span class="o">::</span><span class="n">eDouble</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>


<h3 id="python-tensor-types-usage">Python Tensor Types Usage<a class="headerlink" href="#python-tensor-types-usage" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">spirv</span> <span class="o">=</span> <span class="n">compile_source</span><span class="p">(</span><span class="n">shader</span><span class="p">)</span>

    <span class="n">arr_in_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">123.</span><span class="p">,</span> <span class="mf">153.</span><span class="p">,</span> <span class="mf">231.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">arr_in_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9482</span><span class="p">,</span> <span class="mi">1208</span><span class="p">,</span> <span class="mi">1238</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">arr_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="n">mgr</span> <span class="o">=</span> <span class="n">kp</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>

    <span class="n">tensor_in_a</span> <span class="o">=</span> <span class="n">mgr</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">arr_in_a</span><span class="p">)</span>
    <span class="n">tensor_in_b</span> <span class="o">=</span> <span class="n">mgr</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">arr_in_b</span><span class="p">)</span>
    <span class="n">tensor_out</span> <span class="o">=</span> <span class="n">mgr</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">arr_out</span><span class="p">)</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor_in_a</span><span class="p">,</span> <span class="n">tensor_in_b</span><span class="p">,</span> <span class="n">tensor_out</span><span class="p">]</span>

    <span class="p">(</span><span class="n">mgr</span><span class="o">.</span><span class="n">sequence</span><span class="p">()</span>
        <span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">kp</span><span class="o">.</span><span class="n">OpTensorSyncDevice</span><span class="p">(</span><span class="n">params</span><span class="p">))</span>
        <span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">kp</span><span class="o">.</span><span class="n">OpAlgoDispatch</span><span class="p">(</span><span class="n">mgr</span><span class="o">.</span><span class="n">algorithm</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">spirv</span><span class="p">)))</span>
        <span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">kp</span><span class="o">.</span><span class="n">OpTensorSyncLocal</span><span class="p">([</span><span class="n">tensor_out</span><span class="p">]))</span>
        <span class="o">.</span><span class="n">eval</span><span class="p">())</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">tensor_out</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="o">==</span> <span class="n">arr_in_a</span> <span class="o">*</span> <span class="n">arr_in_b</span><span class="p">)</span>
</pre></div>
</div>



<h2 id="variable-push-constants">Variable Push Constants<a class="headerlink" href="#variable-push-constants" title="Permalink to this headline">¶</a></h2>
<p>Push constants are a relatively non-expensive way to provide dynamic data to a GPU Algorithm (shader) as further CPU compute is performed. Although Push Constants are a more efficient way to provide data, it is also a limited manner as there is a memory limit for push constants.</p>
<p>Push constants with Kompute are flexible as it is possible to pass user-defined structs in C++. In Python it is limited to providing numpy arrays with multiple elements of the same type.</p>

<h3 id="c-push-consts-types-usage">C++ Push Consts Types Usage<a class="headerlink" href="#c-push-consts-types-usage" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above, this test under <cite>TestPushConstants.cpp</cite> shows how it is possible to use user-defined structs for multiple elements from different types, which is not possible for specialized constants or tensors.</p>
<p>These are defined in the <cite>algorithm</cite> function of the <cite>kp::Manager</cite>, and once it push constant is set, all other push constants provided have to consist of the same types and element size.</p>
<p>More specifically, when passing a custom struct it is possible to pass a single element, or alternatively passing multiple scalar values as part of the vector, and access them as outlined in the rest of the tests.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">TEST</span><span class="p">(</span><span class="n">TestPushConstants</span><span class="p">,</span> <span class="n">TestConstantsMixedTypes</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="nf">shader</span><span class="p">(</span><span class="n">R</span><span class="s">"(</span>
          <span class="cp">#version 450</span>
          <span class="n">layout</span><span class="p">(</span><span class="n">push_constant</span><span class="p">)</span> <span class="n">uniform</span> <span class="n">PushConstants</span> <span class="p">{</span>
            <span class="kt">float</span> <span class="n">x</span><span class="p">;</span>
            <span class="n">uint</span> <span class="n">y</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">z</span><span class="p">;</span>
          <span class="p">}</span> <span class="n">pcs</span><span class="p">;</span>
          <span class="n">layout</span> <span class="p">(</span><span class="n">local_size_x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="n">in</span><span class="p">;</span>
          <span class="n">layout</span><span class="p">(</span><span class="n">set</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">binding</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">buffer</span> <span class="n">a</span> <span class="p">{</span> <span class="kt">float</span> <span class="n">pa</span><span class="p">[];</span> <span class="p">};</span>
          <span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
              <span class="n">pa</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pcs</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
              <span class="n">pa</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pcs</span><span class="p">.</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2147483000</span><span class="p">;</span>
              <span class="n">pa</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">pcs</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
          <span class="p">})</span><span class="s">");</span>

        <span class="k">struct</span> <span class="nc">TestConsts</span><span class="p">{</span>
            <span class="kt">float</span> <span class="n">x</span><span class="p">;</span>
            <span class="kt">uint32_t</span> <span class="n">y</span><span class="p">;</span>
            <span class="kt">int32_t</span> <span class="n">z</span><span class="p">;</span>
        <span class="p">};</span>

        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;</span> <span class="n">spirv</span> <span class="o">=</span> <span class="n">compileSource</span><span class="p">(</span><span class="n">shader</span><span class="p">);</span>

        <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">Sequence</span><span class="o">&gt;</span> <span class="n">sq</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>

        <span class="p">{</span>
            <span class="n">kp</span><span class="o">::</span><span class="n">Manager</span> <span class="n">mgr</span><span class="p">;</span>

            <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">TensorT</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;&gt;</span> <span class="n">tensor</span> <span class="o">=</span>
              <span class="n">mgr</span><span class="p">.</span><span class="n">tensorT</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">({</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">});</span>

            <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">Algorithm</span><span class="o">&gt;</span> <span class="n">algo</span> <span class="o">=</span> <span class="n">mgr</span><span class="p">.</span><span class="n">algorithm</span><span class="o">&lt;</span><span class="kt">float</span><span class="p">,</span> <span class="n">TestConsts</span><span class="o">&gt;</span><span class="p">(</span>
              <span class="p">{</span> <span class="n">tensor</span> <span class="p">},</span> <span class="n">spirv</span><span class="p">,</span> <span class="n">kp</span><span class="o">::</span><span class="n">Workgroup</span><span class="p">({</span> <span class="mi">1</span> <span class="p">}),</span> <span class="p">{},</span> <span class="p">{{</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">}});</span>

            <span class="n">sq</span> <span class="o">=</span> <span class="n">mgr</span><span class="p">.</span><span class="n">sequence</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">eval</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">OpTensorSyncDevice</span><span class="o">&gt;</span><span class="p">({</span> <span class="n">tensor</span> <span class="p">});</span>

            <span class="c1">// We need to run this in sequence to avoid race condition</span>
            <span class="c1">// We can't use atomicAdd as swiftshader doesn't support it for</span>
            <span class="c1">// float</span>
            <span class="n">sq</span><span class="o">-&gt;</span><span class="n">eval</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">OpAlgoDispatch</span><span class="o">&gt;</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">TestConsts</span><span class="o">&gt;</span><span class="p">{{</span> <span class="mf">15.32</span><span class="p">,</span> <span class="mi">2147483650</span><span class="p">,</span> <span class="mi">10</span> <span class="p">}});</span>
            <span class="n">sq</span><span class="o">-&gt;</span><span class="n">eval</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">OpAlgoDispatch</span><span class="o">&gt;</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">TestConsts</span><span class="o">&gt;</span><span class="p">{{</span> <span class="mf">30.32</span><span class="p">,</span> <span class="mi">2147483650</span><span class="p">,</span> <span class="mi">-3</span> <span class="p">}});</span>
            <span class="n">sq</span><span class="o">-&gt;</span><span class="n">eval</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">OpTensorSyncLocal</span><span class="o">&gt;</span><span class="p">({</span> <span class="n">tensor</span> <span class="p">});</span>

            <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">tensor</span><span class="o">-&gt;</span><span class="n">vector</span><span class="p">(),</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">({</span> <span class="mf">45.64</span><span class="p">,</span> <span class="mi">1300</span><span class="p">,</span> <span class="mi">7</span> <span class="p">}));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>


<h3 id="python-push-consts-types-usage">Python Push Consts Types Usage<a class="headerlink" href="#python-push-consts-types-usage" title="Permalink to this headline">¶</a></h3>
<p>In python the push constants are limited to a single list of elements of the same type. These are provided by passing a numpy array to the <cite>algorithm</cite> function or the <cite>kp::OpAlgoDispatch</cite> operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dtype value </span><span class="si">{</span><span class="n">tensor_out</span><span class="o">.</span><span class="n">data</span><span class="p">()</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">tensor_out</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="o">==</span> <span class="n">arr_in_a</span> <span class="o">*</span> <span class="n">arr_in_b</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_tensor_numpy_ownership</span><span class="p">():</span>

    <span class="n">arr_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">kp</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">arr_in</span><span class="p">)</span>

    <span class="c1"># This should increment refcount for tensor sharedptr</span>
    <span class="n">td</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">td</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">is_init</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">td</span> <span class="o">==</span> <span class="n">arr_in</span><span class="p">)</span>

    <span class="k">del</span> <span class="n">t</span>

    <span class="k">assert</span> <span class="n">td</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">is_init</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">td</span> <span class="o">==</span> <span class="n">arr_in</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">td</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">is_init</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span>

</pre></div>
</div>



<h2 id="variable-specialization-constants">Variable Specialization Constants<a class="headerlink" href="#variable-specialization-constants" title="Permalink to this headline">¶</a></h2>
<p>Specialization constants are analogous to push constants, but these are not dynamic, can only be set on initialization or rebuild of <cite>kp::Algorithm</cite> and cannot be changed unless a <cite>rebuild</cite> is carried out.</p>
<p>The usage of specailization constants is very similar to the push constants, but the only limitation are:</p>
<ul class="simple">
<li><p>These are defined using the constant_id in the glsl shader</p></li>
<li><p>Spec constants do not support complex types (i.e. user defined struct)</p></li>
<li><p>Kompute supports an array of elements of same type for specialization constants</p></li>
</ul>

<h3 id="id1">C++ Push Consts Types Usage<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The specialization constant example shows how it is possible to define as a std::vector.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">TEST</span><span class="p">(</span><span class="n">TestSpecializationConstants</span><span class="p">,</span> <span class="n">TestConstantsInt</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="nf">shader</span><span class="p">(</span><span class="n">R</span><span class="s">"(</span>
          <span class="cp">#version 450</span>
          <span class="n">layout</span> <span class="p">(</span><span class="n">constant_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">cOne</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
          <span class="n">layout</span> <span class="p">(</span><span class="n">constant_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">cTwo</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
          <span class="n">layout</span> <span class="p">(</span><span class="n">local_size_x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="n">in</span><span class="p">;</span>
          <span class="n">layout</span><span class="p">(</span><span class="n">set</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">binding</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">buffer</span> <span class="n">a</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">pa</span><span class="p">[];</span> <span class="p">};</span>
          <span class="n">layout</span><span class="p">(</span><span class="n">set</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">binding</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="n">buffer</span> <span class="n">b</span> <span class="p">{</span> <span class="kt">int</span> <span class="n">pb</span><span class="p">[];</span> <span class="p">};</span>
          <span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
              <span class="n">uint</span> <span class="n">index</span> <span class="o">=</span> <span class="n">gl_GlobalInvocationID</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
              <span class="n">pa</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">cOne</span><span class="p">;</span>
              <span class="n">pb</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">cTwo</span><span class="p">;</span>
          <span class="p">})</span><span class="s">");</span>

        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;</span> <span class="n">spirv</span> <span class="o">=</span> <span class="n">compileSource</span><span class="p">(</span><span class="n">shader</span><span class="p">);</span>

        <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">Sequence</span><span class="o">&gt;</span> <span class="n">sq</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>

        <span class="p">{</span>
            <span class="n">kp</span><span class="o">::</span><span class="n">Manager</span> <span class="n">mgr</span><span class="p">;</span>

            <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">TensorT</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;&gt;</span> <span class="n">tensorA</span> <span class="o">=</span>
              <span class="n">mgr</span><span class="p">.</span><span class="n">tensorT</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;</span><span class="p">({</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">});</span>
            <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">TensorT</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;&gt;</span> <span class="n">tensorB</span> <span class="o">=</span>
              <span class="n">mgr</span><span class="p">.</span><span class="n">tensorT</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;</span><span class="p">({</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">});</span>

            <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">Tensor</span><span class="o">&gt;&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="n">tensorA</span><span class="p">,</span>
                                                                <span class="n">tensorB</span> <span class="p">};</span>

            <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;</span> <span class="n">spec</span><span class="p">({</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">-2</span> <span class="p">});</span>

            <span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">Algorithm</span><span class="o">&gt;</span> <span class="n">algo</span> <span class="o">=</span>
              <span class="n">mgr</span><span class="p">.</span><span class="n">algorithm</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">spirv</span><span class="p">,</span> <span class="p">{},</span> <span class="n">spec</span><span class="p">,</span> <span class="p">{});</span>

            <span class="n">sq</span> <span class="o">=</span> <span class="n">mgr</span><span class="p">.</span><span class="n">sequence</span><span class="p">()</span>
                   <span class="o">-&gt;</span><span class="n">record</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">OpTensorSyncDevice</span><span class="o">&gt;</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
                   <span class="o">-&gt;</span><span class="n">record</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">OpAlgoDispatch</span><span class="o">&gt;</span><span class="p">(</span><span class="n">algo</span><span class="p">)</span>
                   <span class="o">-&gt;</span><span class="n">record</span><span class="o">&lt;</span><span class="n">kp</span><span class="o">::</span><span class="n">OpTensorSyncLocal</span><span class="o">&gt;</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
                   <span class="o">-&gt;</span><span class="n">eval</span><span class="p">();</span>

            <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">tensorA</span><span class="o">-&gt;</span><span class="n">vector</span><span class="p">(),</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;</span><span class="p">({</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">-1</span> <span class="p">}));</span>
            <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">tensorB</span><span class="o">-&gt;</span><span class="n">vector</span><span class="p">(),</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;</span><span class="p">({</span> <span class="mi">-2</span><span class="p">,</span> <span class="mi">-2</span><span class="p">,</span> <span class="mi">-2</span> <span class="p">}));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>





          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="ci-tests.html" title="CI, Docker Images, Docs &amp; Tests"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> CI, Docker Images, Docs &amp; Tests </span>
              </div>
            </a>
          
          
            <a href="async-parallel.html" title="Asynchronous and Parallel Operations"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Asynchronous and Parallel Operations </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, The Institute for Ethical AI &amp; Machine Learning.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>